---
- hosts: "{{ my_hosts }}"
  gather_facts: yes
  tasks:
          
          #    - name: initialize empty list for devices
          #      set_fact:
          #        storage_devices: []
          #        no_log: false 

          #    - name: get SATA and NVMe devices
          #      set_fact:
          #        storage_devices: "{{ storage_devices + [item.key] }}"
          #      no_log: false
          #      with_dict: "{{ ansible_mounts }}"
  #  when: "item.value.host.startswith('SATA controller:') or
  #         item.value.host.startswith('Non-Volatile memory controller:')"
    - debug:
        msg: "data type of 'ansible_mounts' is {{ ansible_mounts | type_debug }} "

    - name: show all values for selected devices
      debug: 
        msg: "{{ ansible_mounts }}"
        #      loop: "{{ storage_devices }}"

    - name: show devices names
      debug: 
        msg: "device is {{item.device}}"
      loop: "{{ ansible_mounts }}"
      #msg: "{{ ansible_mounts[0] }}"
        #var: storage_devices

    - name: show first SATA or NVMe device in the list
      debug: 
        var: storage_devices[0]
  
