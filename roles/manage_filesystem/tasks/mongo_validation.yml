---
- name: find config files on server
  find:
    paths: "/usr/lib/systemd/system/"
    patterns: "mongo*.service"
    recurse: yes
  register: service

- name: Checking Mongo_config service
  systemd:
    name: "{{ item }}"
  register: mongo_service_status
  with_items: "{{ service.files | map(attribute='path')| map('regex_replace','\\/usr\\/lib\\/systemd\\/system\\/','')| list }}"

  #- debug:
  #    msg: "{{ mongo_service_status }}"

- name: Status of All database services
  debug:
    msg: "The status of {{ item.status.Names }} on {{ ansible_hostname }} is {{ item.status.ActiveState }}"
  with_items:
    - "{{ mongo_service_status.results }}"
