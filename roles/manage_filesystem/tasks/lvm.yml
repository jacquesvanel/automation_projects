---
- name: Create logical volume
  lvol:
    vg: "{{ vg_name.stdout }}"
    lv: "{{ lv_name }}"
    size: "{{ lv_size }}"
#  when: vg_create.changed
  register: lv_create
  ignore_errors: yes

- name: Format logical volume
  filesystem:
    fstype: xfs
    dev: "/dev/{{ vg_name.stdout }}/{{ lv_name }}"
  when: lv_create.changed
  register: lv_format
  ignore_errors: yes

- name: Creates directory
  file:
    path: /{{ lv_name }}
    state: directory
  when: lv_format.changed

- name: Mount logical volume
  mount:
    path: /{{ lv_name }}
    src: /dev/{{ vg_name.stdout }}/{{ lv_name }}
    fstype: xfs
    state: mounted
  when: lv_format.changed
  register: lv_mount
  ignore_errors: yes

