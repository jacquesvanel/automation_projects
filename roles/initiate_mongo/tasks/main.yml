---
# tasks file for initiate_mongo
- name: layout template for /etc/mongo/{{ env }}/shard1_{{ repset }}.cfg on the shard1 server
  template:
    src:  initiate.config.js.j2
    dest: "/etc/mongo/{{ env }}/scripts/initiate.config.js"
    owner: root
    group: root
    mode: '0644'
    force: yes

- name: initiate shard replica set
  shell: mongo {{ host1 }}.opr.afsiep.net:{{ host1_port }} /etc/mongo/{{ env }}/scripts/initiate.config.js
  delegate_to: "{{ host1 }}"

