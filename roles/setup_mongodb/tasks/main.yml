---
- name: install mongodb base
  include_tasks: install_mongodb_base.yml
  tags: 
    - base
    - install

- name: install mongodb tools
  include_tasks: install_mongodb_tools.yml
  tags: 
    - dbtools
    - install

- name: configs for all servers
  include_tasks: allserverconfig.yml
  tags: 
    - make_file
    - add_certs
    - logrotate
    - hugepages
    - mongo_service
    - install
    

- name: install configs
  include_tasks: v2config_tasks.yml
  tags:
    - configsvr
    - shard1
    - shard2
    - shard3
    - mongos

- name: initiate db
  include_tasks: initiate_tasks.yml
  tags: 
    - initiate_db
    - start_mongos
    - add_shards
    - setup_users

- name: create role
  include_tasks: createrole.yml
  tags: create_role

- name: change ldap interval
  include_tasks: ldapintervalchange.yml
  tags: ldap_interval_change


  #- include_tasks: restart_services.yml
  #  when: install_state == 'run_configs_only'

