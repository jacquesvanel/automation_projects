---
- name: layout templates
  template:
    src:  logrotate.conf.j2
    dest: "/etc/logrotate.d/mongo"
    owner: root
    group: root
    mode: '0640'
    force: yes

- name: add cronjob 
  cron:
    name: logrotate for mongodb logs
    min: 23
    job: /usr/sbin/logrotate -f /etc/logrotate.d/mongo

- name: remove files
  file:
    path: "{{ item }}" 
    state: absent
  loop:
    - "/var/log/mongodb/{{ env }}/mongoS0.log"
    - "/var/log/mongodb/{{ env }}/mongoS1.log"
    - "/var/log/mongodb/{{ env }}/mongoS2.log"
