---
- block:
  - name: layout template for etc/mongo/{{ env }}/{{ item }}.cfg on the config server
    template:
      src:  mongod.conf.j2
      dest: "{{ item.dest }}"
      owner: "{{ owner }}"
      group: "{{ group }}"
      mode: '0644'
      force: yes
    loop: "{{ mongos_servers }}"

  - name: Ensure mongos.service file exists
    template:
      src: mongod.service.j2
      dest: "{{ item.dest2 }}"
      owner: "{{ owner }}"
      group: "{{ group }}"
      mode: '0640'
      force: yes
    loop: "{{ mongos_servers }}"
  when: >
        ansible_hostname == 'configsvr_rsa' or
        ansible_hostname == 'configsvr_rsb' or
        ansible_hostname == 'configsvr_rsc' 
  #when: (configsvr_rsa is defined) and (ansible_hostname == configsvr_rsa) or (configsvr_rsb is defined) and (ansible_hostname == configsvr_rsb) or (configsvr_rsc is defined) and (ansible_hostname == configsvr_rsc)
