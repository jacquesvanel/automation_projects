---
# tasks file for mongo_config
- name: make dbpath file directory /data/{{ env }}/{{ shard[1] }}/{{ repset[0] }}
  ansible.builtin.file:
    path: /data/{{ env }}/{{ shard[1] }}/{{ repset[0] }}
    state: directory
    mode: '2770'
    owner: mongod
    group: opr-db-admin
    
- name: create /etc/mongo/{{ env }}
  file:
    path: "/etc/mongo/{{ env }}/"
    owner: root
    group: root
    mode: '0755'
    state: directory

- name: layout template for /etc/mongo/{{ env }}/shard2.conf on the shard2 server
  template:
    src:  shard2.conf.j2
    dest: "/etc/mongo/{{ env }}/shard2.conf"
    owner: root
    group: root
    mode: '0644'
  delegate_to: "{{ shard2 }}"


