---
#sudo useradd mongodb-mms
#Update the following entry in passwd file from /bin/bash to /bin/false:  mongodb-mms:x:1001:1002::/home/mongodb-mms:/bin/false
#vi /etc/passwd    
- name: Add the user 'mongodb-mms' 
  user:
    name: mongodb-mms
    shell: /bin/false
    uid: 1001
    guid: 1002

#Copy the OPS MMS software to /opt
#As root:
#mkdir -p /opt/mongodb/mms
#chown -R mongodb-mms:mongodb-mms /opt/mongodb/mms
- name: create a working directory 
  file:
    path: /opt/mongodb/mms
    state: directory
    owner: mongodb-mms
    group: mongodb-mms
    recurse: true
    
#As Mongodb-mms:
- name: copy mongodb-mms software
  shell: curl -H "X-JFrog-Art-Api:AKCp8nHPEh61X3BeHXSMUK1Kf16XfGBMC7HitRrrad3yFrm2Q8MRinEyokJCnmnwZHy4w4BHn" -O "https://va1artifactoryirs.mgt.afsiep.net:443/artifactory/Mongo-DB/Mongo-Binaries/mongodb-mms-6.0.6.100.20221102T1837Z.tar.gz"
    chdir: /data/mongo_software

#Mongodb-releases
#mkdir /opt/mongodb/mms/mongodb-releases 

- name: create a working directory
  file:
    path: /opt/mongodb/mms/mongodb-releases
    state: directory
    owner: mongodb-mms
    group: mongodb-mms

#--mongosh ( as of 12/6/2022 latest is mongoshâ€¦.tgz ) 
- name: copy mongo mms and opsmanager files into temp
  shell: "{{ item }}"
    chdir: /opt/mongodb/mms/mongodb-releases
  with_items:
     #--Mongotools
     - curl -H "X-JFrog-Art-Api:AKCp8nHPEh61X3BeHXSMUK1Kf16XfGBMC7HitRrrad3yFrm2Q8MRinEyokJCnmnwZHy4w4BHn" -O "https://va1artifactoryirs.mgt.afsiep.net:443/artifactory/Mongo-DB/mongodb-database-tools-rhel80-x86_64-100.6.0.tgz"
     #--5.0.8
     - curl -k -H "X-JFrog-Art-Api:AKCp8nyNrUhuBNKkwD44QG5ketVmNbEFYnBKLtkTMfSKLpUoysUzbgo6gJnedZdxZZZEDWoC1" -O "https://va1imgtlmvn0001.mgt.afsiep.net:443/artifactory/Mongo-DB/Mongo-Binaries/mongodb-linux-x86_64-enterprise-rhel80-5.0.8.tgz"
     #--5.0.13
     - curl -k -H "X-JFrog-Art-Api:AKCp8nyNrUhuBNKkwD44QG5ketVmNbEFYnBKLtkTMfSKLpUoysUzbgo6gJnedZdxZZZEDWoC1" -O "https://va1imgtlmvn0001.mgt.afsiep.net:443/artifactory/Mongo-DB/Mongo-Binaries/mongodb-linux-x86_64-enterprise-rhel80-5.0.13.tgz"

#cp -r /data/mongo_software/mongodb-mms/* /opt/mongodb/mms
- name: Copy file 
  copy:
    src: /data/mongo_software/mongodb-mms/*
    dest: /opt/mongodb/mms/.

