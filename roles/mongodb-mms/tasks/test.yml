---
#Get MongoDB Ops Manager Info
#Get organization info and parse out org_id
- name: Get Org 
  uri:
    url: "{{ ops_manager_host }}{{ api }}/orgs" #groups/{{ project_id }}/hosts?pretty=true"
    method: GET
    url_username: "{{ public_key }}" 
    url_password: "{{ private_key }}"
    headers:
       Accept: "application/json"
    return_content: true
  register: ops_manager_org

- name: Print Response
  debug:
    var: ops_manager_org.json

- set_fact:
    org_id: "{{ ops_manager_org.json.results[0].id }}"
    
- debug:
    var: org_id
#################################################################
- name: Get Projects
  uri:
    url: "{{ ops_manager_host }}{{ api }}/groups/" #{{ project_id }}/hosts?pretty=true"
    method: GET
    url_username: "{{ public_key }}"
    url_password: "{{ private_key }}"
    headers:
       Accept: "application/json"
    return_content: true
  register: ops_manager_projects

- name: Print Response
  debug:
    var: ops_manager_projects.json
