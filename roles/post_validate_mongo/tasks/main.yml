---
- name:
  import_tasks: validation.yml
  tags:
    - validation

- name: shell script
  import_tasks: shell_script.yml
  when: target_hosts == ansible_hostname and target_hosts is defined
  tags:
    - shell

- name: fail module
  fail:
    msg: "The status of {{ item.status.Names }} on {{ ansible_hostname }} is {{ item.status.ActiveState }}"
  when:  item.status.ActiveState == 'failed' or item.status.ActiveState == 'inactive'
  loop: "{{ status.results }}"
  loop_control:
    label: 'status'

- name: fail module
  fail:
    msg: |
         "Mongodb files are different from eachother"
         "{{ diff_result.stdout_lines }}"
  when: diff_result.rc !=0
