---
- name: Run shell to check the mongo services present(SHARDED CLUSTER)
  shell:
    cmd: ps -ef | grep /var/lib/mongodb-mms-automation/mongodb-linux-x86_64-5.0.13-ent/bin/mongod | awk -F " " '{print $10}' | awk 'NR<=3' | awk -F  "/" '{print $4}'
  register: sharded_processes
  when: (sharded_server_type_a_dev is not skipped) or (sharded_server_type_b_dev is not skipped) or (sharded_server_type_c_dev is not skipped) and (ops_manager_check.stdout == "mongodb-mms-automation-agent.service") and (ops_manager_status.stdout == "running")


- name: Run shell to check the mongo services present (CONFIG SERVER)
  shell:
    cmd: ps -ef | grep /var/lib/mongodb-mms-automation/mongodb-linux-x86_64-5.0.13-ent/bin/mongos | awk -F " " '{print $10}' | awk -F "/" '{print $6}' | awk 'NR<=3'
  register: config_process
  when: (config_server_type_a_dev is not skipped) or (config_server_type_b_dev is not skipped) or (config_server_type_c_dev is not skipped) and (ops_manager_check.stdout == "mongodb-mms-automation-agent.service") and (ops_manager_status.stdout == "running")

- name: Run shell to check the mongo services prsent (STAND ALONE SERVER)
  shell:
    cmd: ps -ef | grep /var/lib/mongodb-mms-automation/mongodb-linux-x86_64-5.0.13-ent/bin/mongod | head -1 | awk -F " " '{print $10}' | awk -F "/" '{print $4}'
  register: stand_alone_process
  when: (replicaset_server_type_a_dev is not skipped) or (replicaset_server_type_b_dev is not skipped) or (replicaset_server_type_c_dev is not skipped) and (ops_manager_check.stdout == "mongodb-mms-automation-agent.service") and (ops_manager_status.stdout == "running")
