---
# tasks file for mongo_config
    
- name: layout template for etc/mongo/{{ env }}/mongoS0.cfg on the config server
  template:
    src:  mongos0_config.conf.j2
    dest: "/etc/mongo/{{ env }}/mongoS0.cfg"
    owner: mongod
    group: opr-db-admin
    mode: '0644'
    force: yes

- name: layout template for etc/mongo/{{ env }}/mongoS1.cfg on the config server
  template:
    src:  mongos1_config.conf.j2
    dest: "/etc/mongo/{{ env }}/mongoS1.cfg"
    owner: mongod
    group: opr-db-admin
    mode: '0644'
    force: yes    

- name: layout template for etc/mongo/{{ env }}/mongoS2.cfg on the config server
  template:
    src:  mongos2_config.conf.j2
    dest: "/etc/mongo/{{ env }}/mongoS2.cfg"
    owner: mongod
    group: opr-db-admin
    mode: '0644'
    force: yes

- name: Ensure mongos0.service file exists
  template:
    src: mongos0.service.j2
    dest: "/etc/systemd/system/mongoS0.service"
    owner: mongod
    group: opr-db-admin
    mode: '0640'
    force: yes

- name: Ensure mongos1.service file exists
  template:
    src: mongos1.service.j2
    dest: "/etc/systemd/system/mongoS1.service"
    owner: mongod
    group: opr-db-admin
    mode: '0640'
    force: yes

- name: Ensure mongos2.service file exists
  template:
    src: mongos2.service.j2
    dest: "/etc/systemd/system/mongoS2.service"
    owner: mongod
    group: opr-db-admin
    mode: '0640'
    force: yes
