---
# tasks file for mongo_config
- name: make dbpath file directory /data/{{ env }}/shard3/{{ repset }}
  file:
    path: /data/{{ env }}/shard3/{{ repset }}
    state: directory
    mode: '2775'
    owner: mongod
    group: opr-db-admin

- name: layout template for /etc/mongo/{{ env }}/shard3_{{ repset }}.cfg on the shard1 server
  template:
    src:  testshard.conf.j2
    dest: "/etc/mongo/{{ env }}/shard3_{{ repset }}.cfg"
    owner: mongod
    group: opr-db-admin
    mode: '0644'
    force: yes
    #  delegate_to: "{{ shard1 }}"

- name: layout template for added mongod.service on the server
  template:
    src: mongod.service.j2
    dest: "/usr/lib/systemd/system/mongod.service"
    owner: mongod
    group: opr-db-admin
    mode: '0640'
    force: yes

    #- name: start and enable mongod.service
    #  systemd:
    #    name: mongod
    #    state: stopped
    #    enabled: yes
    #    daemon_reload: yes
