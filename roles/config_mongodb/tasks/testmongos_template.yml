---
- name: layout template for etc/mongo/{{ env }}/mongoS0.cfg on the config server
  template:
    src:  "{{ item }}_config.conf.j2"
    dest: "/etc/mongo/{{ env }}/{{ item }}.cfg"
    owner: mongod
    group: opr-db-admin
    mode: '0644'
    force: yes
  loop:
    - mongos0
    - mongos1
    - mongos2  

- name: Ensure mongos0.service file exists
  template:
    src: "{{ item }}.service.j2"
    dest: "/etc/systemd/system/{{ item }}.service"
    owner: mongod
    group: opr-db-admin
    mode: '0640'
    force: yes
  loop:
    - mongos0
    - mongos1
    - mongos2
